#!/usr/bin/perl 
#
#  This script is used to clean CPP files.  It removes:
#
#       1) Lines with '#' in column 1 (lines inserted by CPP).
#       2) Lines with '!!' in columns 1:2 (double commented lines).
#       3) Lines with '!$!' in columns 1:3 (removes OpenMP directives).
#       4) Blank lines. 
#

my $file = $ARGV[0];
my $tmp = "tmp.$$";
open(FILE, "$file");
open(TMP, ">$tmp") || die "Can't open tmp file";

while (<FILE>) {
   next if /^#/;
   next if /^!!/;
   next if /^!\$\!/;
   next if /^\s*$/;
   print TMP;
} 
close(FILE);
close(TMP);

rename($tmp, $file);

